# TaskManager

TaskManager æ˜¯ä¸€ä¸ªç”¨äºç®¡ç†å’Œæ‰§è¡Œä»»åŠ¡çš„çµæ´»æ¡†æ¶ï¼Œæ”¯æŒä¸²è¡Œã€å¹¶è¡Œã€å¼‚æ­¥åŠå¤šè¿›ç¨‹çš„ä»»åŠ¡æ‰§è¡Œæ–¹å¼ã€‚å®ƒå…·æœ‰å¼ºå¤§çš„é‡è¯•æœºåˆ¶ã€æ—¥å¿—è®°å½•åŠŸèƒ½ã€è¿›åº¦ç®¡ç†ï¼Œä»¥åŠå¤šç§æ‰§è¡Œæ¨¡å¼çš„å…¼å®¹æ€§ã€‚

## ç‰¹æ€§
- **å¤šç§æ‰§è¡Œæ¨¡å¼**ï¼šæ”¯æŒä¸²è¡Œï¼ˆserialï¼‰ã€çº¿ç¨‹æ± ï¼ˆthreadï¼‰ã€è¿›ç¨‹æ± ï¼ˆprocessï¼‰ä»¥åŠå¼‚æ­¥ï¼ˆasyncï¼‰æ‰§è¡Œã€‚
- **é‡è¯•æœºåˆ¶**ï¼šå¯¹äºæŒ‡å®šçš„å¼‚å¸¸ç±»å‹ä»»åŠ¡ï¼Œå¯ä»¥è‡ªåŠ¨é‡è¯•ï¼Œæ”¯æŒæŒ‡æ•°é€€é¿ç­–ç•¥ã€‚
- **æ—¥å¿—è®°å½•**ï¼šä½¿ç”¨ loguru è®°å½•ä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­çš„æˆåŠŸã€å¤±è´¥ã€é‡è¯•ç­‰æƒ…å†µã€‚
- **è¿›åº¦ç®¡ç†**ï¼šæ”¯æŒé€šè¿‡ ProgressManager åŠ¨æ€æ˜¾ç¤ºä»»åŠ¡è¿›åº¦ã€‚
- **ä»»åŠ¡ç»“æœç®¡ç†**ï¼šä»»åŠ¡çš„æ‰§è¡Œç»“æœå’Œé”™è¯¯ä¿¡æ¯è¢«ç»Ÿä¸€è®°å½•å¹¶å¯è·å–ã€‚
- **ä»»åŠ¡å»é‡**ï¼šæ”¯æŒä»»åŠ¡å»é‡ï¼Œé˜²æ­¢é‡å¤ä»»åŠ¡çš„æ‰§è¡Œã€‚
- **èµ„æºé‡Šæ”¾**ï¼šè‡ªåŠ¨ç®¡ç†çº¿ç¨‹æ± å’Œè¿›ç¨‹æ± èµ„æºçš„åˆ›å»ºå’Œå…³é—­ï¼Œé˜²æ­¢èµ„æºæ³„æ¼ã€‚

## å®‰è£…
ç¡®ä¿ä½ çš„ç¯å¢ƒä¸­å·²ç»å®‰è£…äº†ä»¥ä¸‹ä¾èµ–é¡¹ï¼š

```bash
pip install loguru
```

## å¿«é€Ÿä¸Šæ‰‹

### 1. åˆå§‹åŒ– TaskManager
é¦–å…ˆï¼Œå®šä¹‰ä¸€ä¸ªä½ æƒ³è¦å¹¶è¡Œæ‰§è¡Œçš„ä»»åŠ¡å‡½æ•°ã€‚ä»»åŠ¡å‡½æ•°æ¥å—çš„å‚æ•°å½¢å¼å¯ä»¥è‡ªç”±å®šä¹‰ï¼Œç¨åä½ éœ€è¦åœ¨ TaskManager ä¸­å®ç°å¦‚ä½•è·å–è¿™äº›å‚æ•°ã€‚

```python
def example_task(x, y):
    return x + y
```

ç„¶åï¼Œåˆ›å»ºä¸€ä¸ª TaskManager å®ä¾‹ï¼Œå¹¶æŒ‡å®šä½ çš„ä»»åŠ¡å‡½æ•°ã€æ‰§è¡Œæ¨¡å¼å’Œå…¶ä»–é…ç½®å‚æ•°ï¼š

```python
from task_manager import TaskManager

# åˆ›å»ºTaskManagerå®ä¾‹
task_manager = TaskManager(
    func=example_task,
    execution_mode='thread',  # å¯é€‰ï¼šserial, thread, process, async
    worker_limit=5,           # æœ€å¤§å¹¶å‘é™åˆ¶
    max_retries=3,            # æœ€å¤§é‡è¯•æ¬¡æ•°
    show_progress=True        # æ˜¯å¦æ˜¾ç¤ºè¿›åº¦
)
```

### 2. å¯åŠ¨ä»»åŠ¡
å‡†å¤‡å¥½ä»»åŠ¡åˆ—è¡¨åï¼Œå¯ä»¥é€šè¿‡ start æ–¹æ³•å¯åŠ¨ä»»åŠ¡æ‰§è¡Œï¼š

```python
tasks = [(1, 2), (3, 4), (5, 6), (7, 8)]
task_manager.start(tasks)
```

TaskManager å°†æ ¹æ®è®¾å®šçš„æ‰§è¡Œæ¨¡å¼å¹¶å‘æˆ–å¼‚æ­¥åœ°æ‰§è¡Œä»»åŠ¡ï¼Œå¹¶è‡ªåŠ¨å¤„ç†ä»»åŠ¡çš„æˆåŠŸã€å¤±è´¥å’Œé‡è¯•é€»è¾‘ã€‚

### 3. è·å–ä»»åŠ¡ç»“æœ
ä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œå¯ä»¥é€šè¿‡ get_success_dict æ–¹æ³•è·å–æ‰§è¡Œç»“æœï¼Œæˆ–é€šè¿‡ get_error_dict è·å–å¤±è´¥çš„ä»»åŠ¡åŠå…¶å¯¹åº”çš„å¼‚å¸¸ã€‚

```python
# è·å–æˆåŠŸçš„ç»“æœ
results = task_manager.get_success_dict()
print("Results:", results)

# è·å–å¤±è´¥çš„ä»»åŠ¡åŠå…¶å¼‚å¸¸
errors = task_manager.get_error_dict()
print("Errors:", errors)
```

### 4. å…³é—­èµ„æº
åœ¨ä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼ŒåŠ¡å¿…è°ƒç”¨ shutdown_pools æ–¹æ³•ä»¥ç¡®ä¿èµ„æºè¢«æ­£ç¡®é‡Šæ”¾ã€‚

```python
task_manager.shutdown_pools()
```

## ä¸»è¦å‚æ•°å’Œæ–¹æ³•è¯´æ˜

### TaskManager ç±»
func: ä»»åŠ¡æ‰§è¡Œå‡½æ•°ï¼Œå¿…é¡»æ˜¯å¯è°ƒç”¨å¯¹è±¡ã€‚
execution_mode: æ‰§è¡Œæ¨¡å¼ï¼Œæ”¯æŒ 'serial'ã€'thread'ã€'process' å’Œ 'async'ã€‚
worker_limit: æœ€å¤§å¹¶å‘ä»»åŠ¡æ•°ï¼Œé€‚ç”¨äºå¹¶å‘å’Œå¼‚æ­¥æ‰§è¡Œæ¨¡å¼ã€‚
max_retries: ä»»åŠ¡å¤±è´¥æ—¶çš„æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œæ”¯æŒæŒ‡æ•°é€€é¿ã€‚
show_progress: æ˜¯å¦æ˜¾ç¤ºä»»åŠ¡è¿›åº¦æ¡ï¼Œé»˜è®¤ä¸æ˜¾ç¤ºã€‚
progress_desc: è¿›åº¦æ¡çš„æè¿°æ–‡å­—ï¼Œç”¨äºæ ‡è¯†ä»»åŠ¡ç±»å‹ã€‚

### å¸¸ç”¨æ–¹æ³•
start(task_list: List): å¯åŠ¨ä»»åŠ¡æ‰§è¡Œï¼Œtask_list æ˜¯ä»»åŠ¡åˆ—è¡¨ï¼Œæ¯ä¸ªä»»åŠ¡çš„æ ¼å¼å–å†³äºä½ åœ¨ get_args ä¸­å¦‚ä½•å®šä¹‰ã€‚
start_async(task_list: List): å¼‚æ­¥åœ°æ‰§è¡Œä»»åŠ¡ã€‚
get_success_dict() -> dict: è¿”å›ä»»åŠ¡æ‰§è¡Œçš„ç»“æœå­—å…¸ï¼Œé”®æ˜¯ä»»åŠ¡å¯¹è±¡ï¼Œå€¼æ˜¯ä»»åŠ¡ç»“æœã€‚
get_error_dict() -> dict: è¿”å›ä»»åŠ¡æ‰§è¡Œå¤±è´¥çš„å­—å…¸ï¼Œé”®æ˜¯ä»»åŠ¡å¯¹è±¡ï¼Œå€¼æ˜¯å¼‚å¸¸ä¿¡æ¯ã€‚
shutdown_pools(): å…³é—­çº¿ç¨‹æ± å’Œè¿›ç¨‹æ± ï¼Œé‡Šæ”¾èµ„æºã€‚

### è‡ªå®šä¹‰æ–¹æ³•
ä½ å¯ä»¥é€šè¿‡ç»§æ‰¿ TaskManager å¹¶å®ç°ä»¥ä¸‹æ–¹æ³•ï¼Œæ¥è‡ªå®šä¹‰ä»»åŠ¡å¤„ç†çš„é€»è¾‘ï¼š

get_args(task): ä»ä»»åŠ¡å¯¹è±¡ä¸­æå–æ‰§è¡Œå‡½æ•°çš„å‚æ•°ã€‚æ ¹æ®ä»»åŠ¡å¯¹è±¡çš„ç»“æ„ï¼Œè‡ªå®šä¹‰å‚æ•°æå–é€»è¾‘ã€‚
process_result(task, result): å¤„ç†ä»»åŠ¡çš„æ‰§è¡Œç»“æœã€‚å¯ä»¥å¯¹ç»“æœè¿›è¡Œå¤„ç†ã€æ ¼å¼åŒ–æˆ–å­˜å‚¨ã€‚
handle_error(): ç»Ÿä¸€å¤„ç†ä»»åŠ¡æ‰§è¡Œåçš„æ‰€æœ‰é”™è¯¯ã€‚å¯ä»¥è‡ªå®šä¹‰é”™è¯¯å¤„ç†é€»è¾‘ã€‚

**ç¤ºä¾‹**
1. ä¸²è¡Œä»»åŠ¡æ‰§è¡Œ
```python
task_manager = TaskManager(func=example_task, execution_mode='serial')
task_manager.start(tasks)
```
2. å¤šçº¿ç¨‹ä»»åŠ¡æ‰§è¡Œ
```python
task_manager = TaskManager(func=example_task, execution_mode='thread', worker_limit=10)
task_manager.start(tasks)
```
3. å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œ
```python
async def example_async_task(x, y):
    await asyncio.sleep(1)
    return x + y

task_manager = TaskManager(func=example_async_task, execution_mode='async', worker_limit=5)
await task_manager.start_async(tasks)
```

## æ—¥å¿—
TaskManager ä½¿ç”¨ loguru è¿›è¡Œæ—¥å¿—è®°å½•ï¼Œé»˜è®¤å°†æ—¥å¿—ä¿å­˜åˆ° logs/ ç›®å½•ä¸‹ã€‚ä½ å¯ä»¥é€šè¿‡è‡ªå®šä¹‰ TaskLogger æ¥ä¿®æ”¹æ—¥å¿—æ ¼å¼æˆ–è·¯å¾„ã€‚

## è¿›é˜¶

### è‡ªå®šä¹‰ä»»åŠ¡å‚æ•°
å¦‚æœä½ çš„ä»»åŠ¡å¯¹è±¡æœ‰å¤æ‚çš„å‚æ•°ï¼Œå¯ä»¥é€šè¿‡ç»§æ‰¿ TaskManager å¹¶é‡å†™ get_args æ–¹æ³•ï¼Œæ¥è‡ªå®šä¹‰å‚æ•°çš„æå–æ–¹å¼ã€‚ä¾‹å¦‚ï¼š

```python
class MyTaskManager(TaskManager):
    def get_args(self, task):
        return task['x'], task['y']
```

### é‡è¯•æœºåˆ¶
å¯¹äºå®šä¹‰çš„ retry_exceptionsï¼Œå¦‚ TimeoutError æˆ– ConnectionErrorï¼ŒTaskManager å°†è‡ªåŠ¨é‡è¯•è¿™äº›ä»»åŠ¡ã€‚å¦‚æœä½ æœ‰è‡ªå®šä¹‰çš„å¼‚å¸¸ç±»å‹ï¼Œå¯ä»¥é€šè¿‡è®¾ç½® self.retry_exceptions æ¥æ‰©å±•é‡è¯•é€»è¾‘ã€‚

# TaskTree

TaskTree æ˜¯ä¸€ä¸ªç”¨äºç»„ç»‡å’Œæ‰§è¡Œå¤šé˜¶æ®µä»»åŠ¡é“¾çš„æ¡†æ¶ã€‚æ¯ä¸ªé˜¶æ®µéƒ½æ˜¯ç”± TaskManager å®ä¾‹ç»„æˆï¼Œä»»åŠ¡é“¾å¯ä»¥ä¸²è¡Œæˆ–å¹¶è¡Œæ‰§è¡Œã€‚åœ¨ä»»åŠ¡é“¾ä¸­ï¼Œä»»åŠ¡ä¼šä¾æ¬¡é€šè¿‡æ¯ä¸ªé˜¶æ®µçš„å¤„ç†ï¼Œå¹¶æœ€ç»ˆè¿”å›ç»“æœã€‚

## ç‰¹æ€§

- **å¤šé˜¶æ®µä»»åŠ¡ç®¡ç†**ï¼šTaskTree å°†å¤šä¸ª TaskManager å®ä¾‹è¿æ¥èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªä»»åŠ¡é“¾ï¼Œæ¯ä¸ªä»»åŠ¡ç»è¿‡å„ä¸ªé˜¶æ®µçš„å¤„ç†ã€‚
- **æ‰§è¡Œæ¨¡å¼**ï¼šæ”¯æŒä¸²è¡Œï¼ˆserialï¼‰å’Œå¤šè¿›ç¨‹å¹¶è¡Œï¼ˆprocessï¼‰æ‰§è¡Œæ–¹å¼ã€‚
- **ä»»åŠ¡ç»“æœè¿½è¸ª**ï¼šèƒ½å¤Ÿè·Ÿè¸ªåˆå§‹ä»»åŠ¡åœ¨æ•´ä¸ªä»»åŠ¡é“¾ä¸­çš„æœ€ç»ˆç»“æœã€‚
- **åŠ¨æ€é˜¶æ®µç®¡ç†**ï¼šå¯ä»¥åŠ¨æ€æ·»åŠ ã€ç§»é™¤æˆ–ä¿®æ”¹ä»»åŠ¡é“¾ä¸­çš„é˜¶æ®µã€‚

## ä¾èµ–
TaskTree åŸºäº TaskManager æ„å»ºï¼Œå› æ­¤éœ€è¦å…ˆå®‰è£… TaskManager ç›¸å…³ä¾èµ–ï¼š

```bash
pip install loguru
```

## å¿«é€Ÿä¸Šæ‰‹
### 1. åˆå§‹åŒ– TaskTree
é¦–å…ˆï¼Œå‡†å¤‡å¤šä¸ª TaskManager å®ä¾‹ï¼Œæ¯ä¸ªå®ä¾‹ä»£è¡¨ä»»åŠ¡é“¾ä¸­çš„ä¸€ä¸ªé˜¶æ®µã€‚ç„¶åï¼Œåˆ›å»ºä¸€ä¸ª TaskTree å®ä¾‹ï¼Œå°†è¿™äº› TaskManager å®ä¾‹ä½œä¸ºå‚æ•°ä¼ é€’ç»™ TaskTreeã€‚

```python
from task_manager import TaskManager, TaskTree

# å®šä¹‰å‡ ä¸ªç®€å•çš„ä»»åŠ¡å‡½æ•°
def task_stage_1(x):
    return x + 1

def task_stage_2(x):
    return x * 2

# åˆ›å»º TaskManager å®ä¾‹ï¼Œä»£è¡¨ä¸åŒçš„ä»»åŠ¡é˜¶æ®µ
stage_1 = TaskManager(func=task_stage_1, execution_mode='serial')
stage_2 = TaskManager(func=task_stage_2, execution_mode='thread')

# åˆ›å»º TaskTree å®ä¾‹
task_tree = TaskTree(stages=[stage_1, stage_2])
```

### 2. å¯åŠ¨ä»»åŠ¡é“¾
å‡†å¤‡å¥½åˆå§‹ä»»åŠ¡åˆ—è¡¨åï¼Œé€šè¿‡ start_tree æ–¹æ³•å¯åŠ¨ä»»åŠ¡é“¾æ‰§è¡Œã€‚ä»»åŠ¡å°†ä¾æ¬¡é€šè¿‡æ¯ä¸ªé˜¶æ®µè¿›è¡Œå¤„ç†ã€‚

```python
# å®šä¹‰åˆå§‹ä»»åŠ¡
initial_tasks = [1, 2, 3, 4]

# å¯åŠ¨ä»»åŠ¡é“¾ï¼ˆé»˜è®¤ä¸²è¡Œæ¨¡å¼ï¼‰
task_tree.start_tree(initial_tasks)
```

### 3. è·å–æœ€ç»ˆç»“æœ
ä»»åŠ¡é“¾æ‰§è¡Œå®Œæˆåï¼Œå¯ä»¥é€šè¿‡ get_final_result_dict æ–¹æ³•è·å–æ¯ä¸ªåˆå§‹ä»»åŠ¡çš„æœ€ç»ˆå¤„ç†ç»“æœã€‚

```python
# è·å–ä»»åŠ¡é“¾çš„æœ€ç»ˆç»“æœ
final_results = task_tree.get_final_result_dict()
print("Final Results:", final_results)
```

### 4. å¹¶è¡Œæ‰§è¡Œä»»åŠ¡é“¾
å¦‚æœä»»åŠ¡é“¾ä¸­çš„æ¯ä¸ªé˜¶æ®µéœ€è¦å¹¶è¡Œå¤„ç†ä»»åŠ¡ï¼Œå¯ä»¥å°† tree_mode è®¾ç½®ä¸º 'process'ï¼Œå¹¶å¯åŠ¨ä»»åŠ¡é“¾ã€‚è¿™ä¼šä½¿ç”¨å¤šè¿›ç¨‹æ¥å¹¶è¡Œå¤„ç†ä»»åŠ¡é“¾ä¸­çš„æ¯ä¸ªé˜¶æ®µï¼Œæ­¤æ—¶æ¯ä¸ªé˜¶æ®µçš„å¤„ç†ç»“æœä¼šç«‹åˆ»äº¤ç»™ä¸‹ä¸€é˜¶æ®µè¿›è¡Œå¤„ç†ã€‚

```python
task_tree.set_tree_mode('process')
task_tree.start_tree(initial_tasks)
```

## ä¸»è¦å‚æ•°å’Œæ–¹æ³•è¯´æ˜
### TaskTree ç±»
- **stages**: ä¸€ä¸ªåŒ…å« TaskManager å®ä¾‹çš„åˆ—è¡¨ï¼Œä»£è¡¨ä»»åŠ¡é“¾çš„å„ä¸ªé˜¶æ®µã€‚
- **tree_mode**: ä»»åŠ¡é“¾çš„æ‰§è¡Œæ¨¡å¼ï¼Œæ”¯æŒ 'serial'ï¼ˆä¸²è¡Œï¼‰å’Œ 'process'ï¼ˆå¹¶è¡Œï¼‰ã€‚é»˜è®¤ä¸ºä¸²è¡Œæ¨¡å¼ã€‚

### å¸¸ç”¨æ–¹æ³•
- set_tree_mode(tree_mode: str): è®¾ç½®ä»»åŠ¡é“¾çš„æ‰§è¡Œæ¨¡å¼ï¼Œå¯ä»¥é€‰æ‹© 'serial' æˆ– 'process'ã€‚
- add_stage(stage: TaskManager): åŠ¨æ€æ·»åŠ ä¸€ä¸ªæ–°çš„ä»»åŠ¡é˜¶æ®µåˆ°ä»»åŠ¡é“¾ä¸­ã€‚
- remove_stage(index: int): ç§»é™¤ä»»åŠ¡é“¾ä¸­æŒ‡å®šç´¢å¼•çš„é˜¶æ®µã€‚
- start_tree(tasks: List): å¯åŠ¨ä»»åŠ¡é“¾ï¼Œä¼ å…¥åˆå§‹ä»»åŠ¡åˆ—è¡¨ã€‚æ ¹æ® tree_mode é€‰æ‹©ä¸²è¡Œæˆ–å¹¶è¡Œæ–¹å¼æ‰§è¡Œä»»åŠ¡é“¾ã€‚
- run_tree_in_serial(tasks: List): ä¸²è¡Œåœ°æ‰§è¡Œä»»åŠ¡é“¾ä¸­çš„æ¯ä¸ªé˜¶æ®µã€‚
- run_tree_in_process(tasks: List): ä½¿ç”¨å¤šè¿›ç¨‹å¹¶è¡Œåœ°æ‰§è¡Œä»»åŠ¡é“¾ä¸­çš„æ¯ä¸ªé˜¶æ®µã€‚
- get_final_result_dict() -> dict: è·å–åˆå§‹ä»»åŠ¡åœ¨æ•´ä¸ªä»»åŠ¡é“¾ä¸­æœ€ç»ˆå¤„ç†çš„ç»“æœå­—å…¸ã€‚

## TaskTree å…³é”®åŠŸèƒ½è§£é‡Š
### ä¸²è¡Œæ¨¡å¼ï¼ˆserialï¼‰

æ¯ä¸ªä»»åŠ¡ä¾æ¬¡ç»è¿‡ä»»åŠ¡é“¾çš„æ‰€æœ‰é˜¶æ®µï¼Œå‰ä¸€ä¸ªé˜¶æ®µçš„è¾“å‡ºä½œä¸ºä¸‹ä¸€ä¸ªé˜¶æ®µçš„è¾“å…¥ã€‚

### å¹¶è¡Œæ¨¡å¼ï¼ˆprocessï¼‰

æ¯ä¸ªé˜¶æ®µåœ¨ç‹¬ç«‹çš„è¿›ç¨‹ä¸­å¹¶è¡Œæ‰§è¡Œï¼Œä½¿ç”¨å¤šè¿›ç¨‹é˜Ÿåˆ—ï¼ˆMPQueueï¼‰åœ¨é˜¶æ®µé—´ä¼ é€’ä»»åŠ¡ç»“æœã€‚ä»»åŠ¡åœ¨ç¬¬ä¸€ä¸ªé˜¶æ®µçš„ç»“æœä¼šä½œä¸ºè¾“å…¥ä¼ é€’ç»™ä¸‹ä¸€ä¸ªé˜¶æ®µï¼Œç›´åˆ°æ‰€æœ‰é˜¶æ®µå®Œæˆã€‚

## ä»»åŠ¡é“¾çš„å·¥ä½œæµç¨‹
- åˆå§‹åŒ–ä»»åŠ¡é˜Ÿåˆ—ï¼šåˆå§‹ä»»åŠ¡åˆ—è¡¨è¢«æ”¾å…¥ç¬¬ä¸€ä¸ªé˜¶æ®µçš„ä»»åŠ¡é˜Ÿåˆ—ä¸­ã€‚
- é˜¶æ®µæ‰§è¡Œï¼šæ¯ä¸ªé˜¶æ®µåˆ†åˆ«å¤„ç†ä»»åŠ¡ï¼Œä¸²è¡Œæˆ–å¹¶è¡Œæ¨¡å¼ä¸‹ï¼Œä»»åŠ¡é€šè¿‡å„ä¸ªé˜¶æ®µçš„å¤„ç†ã€‚
- ç»“æœæ”¶é›†ï¼šæ¯ä¸ªé˜¶æ®µçš„ç»“æœä¼šä¼ é€’åˆ°ä¸‹ä¸€ä¸ªé˜¶æ®µï¼Œæœ€ç»ˆè·å–åˆå§‹ä»»åŠ¡çš„æœ€ç»ˆå¤„ç†ç»“æœã€‚

## ç¤ºä¾‹
### 1. ä¸²è¡Œä»»åŠ¡é“¾
```python
# åˆ›å»º TaskTree å®ä¾‹
task_tree = TaskTree(stages=[stage_1, stage_2], tree_mode='serial')

# å®šä¹‰åˆå§‹ä»»åŠ¡
initial_tasks = [1, 2, 3, 4]

# å¯åŠ¨ä»»åŠ¡é“¾
task_tree.start_tree(initial_tasks)

# è·å–æœ€ç»ˆç»“æœ
final_results = task_tree.get_final_result_dict()
print("Final Results:", final_results)
```
### 2. å¹¶è¡Œä»»åŠ¡é“¾
```python
# åˆ›å»º TaskTree å®ä¾‹
task_tree = TaskTree(stages=[stage_1, stage_2], tree_mode='process')

# å®šä¹‰åˆå§‹ä»»åŠ¡
initial_tasks = [1, 2, 3, 4]

# å¯åŠ¨ä»»åŠ¡é“¾ï¼ˆå¹¶è¡Œæ¨¡å¼ï¼‰
task_tree.start_tree(initial_tasks)

# è·å–æœ€ç»ˆç»“æœ
final_results = task_tree.get_final_result_dict()
print("Final Results:", final_results)
```

# å…¶ä»–èŠ‚ç‚¹

## ä¸‹ä¸€æ­¥æ‰©å±•æ–¹å‘
| æ¨¡å—                     | åŠŸèƒ½                                                        |
|--------------------------|-------------------------------------------------------------|
| âœ… TaskSplitter          | å·²å®Œæˆï¼Œfan-out æˆåŠŸ                                        |
| ğŸ”„ TaskRouterï¼ˆåˆ†æ”¯æ§åˆ¶ï¼‰| æ ¹æ®æ¡ä»¶å°†ä»»åŠ¡è·¯ç”±åˆ°ä¸åŒçš„ stage                            |
| ğŸ“¦ TaskMerger            | å°†å¤šä¸ªç»“æœèšåˆåå¤„ç†ï¼ˆfan-inï¼‰                              |
| ğŸ” TaskTracer / Inspector| ç»™æ¯ä¸ªä»»åŠ¡æ ‡è®° trace_idã€è·¯å¾„                               |
| ğŸ“Š ChainVisualizer       | ç»“æ„å›¾ï¼ˆnetworkx / graphvizï¼‰å¯è§†åŒ–é“¾è·¯                    |
| ğŸ–¥ï¸ Web UI                | ç”¨ Flask / FastAPI + Vue åšä¸€ä¸ªå°ç›‘æ§ç•Œé¢                   |
| ğŸ’¾ æŒä¹…åŒ–æ”¯æŒ            | Redis / SQLite å­˜ task çŠ¶æ€ï¼Œæ”¯æŒæ–­ç‚¹æ¢å¤                   |


# è´¡çŒ®
æ¬¢è¿å¯¹æœ¬é¡¹ç›®æå‡ºæ”¹è¿›å»ºè®®æˆ–æäº¤ PRã€‚å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·æäº¤ issuesã€‚

